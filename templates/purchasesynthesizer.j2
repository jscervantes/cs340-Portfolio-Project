{% extends "base.j2" %}

{% block content %}
    <h2>Purchase Synthesizer</h2>
    <div id="browse">
        <table>
            {% if data %}
                <thead>
                    <tr>
                        {% for key in data[0].keys() %}
					    <th scope="col" data-field="{{ key }}" data-filter-control="input">{{ key }}</th>
                        {% endfor %} 
                    </tr>

                    <tbody>
                        {% for item in data %}
                        <tr>
                            {% for key in item.keys() %}
                                <td> {{item[key]}} </td>
                            {%endfor %}
                        </tr>
                        {% endfor %}
                      </tbody>
            {% endif %}
        </table>

        <td><button id="add-button" onclick="showAddForm()">Add</button></td>

    <br>


    <!--insert-->
    <form method="post" id="add-form" style="display: none;">
    <h3>{% block addForm %} Add A Synthesizer Purchase to Database {% endblock %}</h3>
        <label for="purchaseID">Purchase</label>
        <br>
         {% if purchaseIds %}
            <label for="purchaseID">Purchase ID</label>
            <select required id="purchaseID" name="purchaseID">
                <option value="" disabled selected>Select the Associated Purchase</option>
                {% for id in purchaseIds %}
                  <option value="{{id.purchaseID}}">PurchaseID: {{id.purchaseID}}</option>
                {% endfor %}
            </select>
          {% endif %}
        <br>
          {% if synthesizersNames %}
            <label for="synthesizerID">Synthesizers</label>
            <select required id="synthesizerID" name="synthesizerID">
                <option value="" disabled selected>Select the Synthesizer</option>
                {% for synthesizer in synthesizersNames %}
                  <option value="{{synthesizer.synthesizerID}}">ID: {{synthesizer.synthesizerID}} {{synthesizer.synthesizerName}}</option>
                {% endfor %}
            </select>
          {% endif %}
        <br>
        <label for="quantity">Quantity</label>
        <br>
        <input type="number" 
               id="quantity"
               name="quantity"
               min = "1"
               required>
        <br>
        <input type="submit" value="Add to Purchase" name="Add_PurchaseSynthesizer">
      </form>

</body>
</html>


 <script>
function purchaseSynthesizerSearch() {
  var purchaseSelectionID, filter, table, tr, td, i, dropDownValue;
  purchaseSelectionID = document.getElementById("purchaseSynthesizerTableInput");
  filter = purchaseSelectionID.value.toUpperCase();
  table = document.getElementById("purchaseSynthesizerTable");
  tr = table.getElementsByTagName("tr");

  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1];
    if (td) {
      dropDownValue = td.textContent || td.innerText;
      if (dropDownValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
}
</script>

<script>
 function showAddForm() {
  document.getElementById('add-form').style.display = 'block';
 }
</script>

{% endblock content %}